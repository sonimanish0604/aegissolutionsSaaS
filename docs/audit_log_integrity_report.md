---
title: "Audit Log Integrity Control Evidence Report"
author: "Aegis Solutions – Platform Engineering"
date: "{{REPORT_DATE}}"
geometry: margin=1in
fontsize: 11pt
---

# 1. Overview

**Reporting Period:** {{PERIOD_START}} → {{PERIOD_END}}  
**Environment:** {{ENVIRONMENT}}  
**System Boundary:** Aegis ISO20022 API / Audit Pipeline  

---

# 2. Control Objective

To ensure all audit records generated by Aegis SaaS are complete, tamper-evident, and retained
in compliance with SOC 2 (CC7.2, CC7.3) and ISO 27001 (A.12.4.2 – A.12.4.3).

---

# 3. Control Design Summary

| Component | Description |
|------------|-------------|
| **Source** | Each API invocation (`/translate`, `/validate`) emits a compact, PII-free JSON event with `tenant_id`, `x_request_id`, `event_id`, hashes, and timestamps. |
| **Transport** | Events are queued to Kafka topic `audit.events` using idempotent producers. |
| **Archive Sink** | Kafka Connect S3 Sink batches events hourly into **Parquet** under `dt=YYYY/MM/DD/HH/tenant_id=...`. |
| **Integrity Mechanism** | Lambda **Manifest Builder** computes SHA-256 for each object, builds `MANIFEST.json`, and signs it with **AWS KMS**. |
| **Storage Controls** | S3 Object Lock (Compliance) + SSE-KMS encryption; retention = 7 years. |
| **Verification** | Daily Lambda recomputes hashes, verifies KMS signature; logs result to CloudWatch and SIEM. |

---

# 4. Evidence of Operation

| Date/Time (UTC) | Partition Prefix | Manifest Hash (SHA-256) | Verification Status | Verified By | CloudTrail Event ID |
|------------------|-----------------|--------------------------|--------------------|--------------|----------------------|
{{VERIFICATION_TABLE}}

**Summary:** {{VERIFICATION_SUMMARY}}

---

# 5. Configuration Snapshot

| Setting | Value / Evidence |
|----------|------------------|
| **S3 Object Lock Mode** | {{OBJECT_LOCK_MODE}} |
| **Retention Period** | {{RETENTION_PERIOD}} days |
| **Lifecycle Rule** | {{LIFECYCLE_RULE}} |
| **KMS Key Rotation** | {{KMS_ROTATION_STATUS}} |
| **Manifest Signer Role** | {{SIGNER_ROLE_ARN}} |
| **Allowed KMS Actions** | `kms:Sign`, `kms:Verify` |
| **Key Policy Review Date** | {{POLICY_REVIEW_DATE}} |
| **SIEM Forwarder** | {{SIEM_FORWARDER_STATUS}} |

---

# 6. Automated Verification Job Results

| Metric | Value |
|---------|-------|
| **Total manifests verified** | {{TOTAL_VERIFIED}} |
| **Failed verifications** | {{FAILED_VERIFICATIONS}} |
| **Missing objects** | {{MISSING_OBJECTS}} |
| **Average verification time** | {{AVG_VERIFY_TIME}} |
| **CloudTrail retention** | {{CLOUDTRAIL_RETENTION}} days |

---

# 7. Exceptions / Observations

| ID | Date | Description | Resolution |
|----|------|--------------|-------------|
{{EXCEPTION_TABLE}}

---

# 8. Control Owner Review

**Control Owner:** Manish Soni  
**Date Reviewed:** {{REVIEW_DATE}}  
**Findings:** {{FINDINGS_SUMMARY}}

**Digital Signature:** _____________________________

---

# 9. Framework Mapping

| Framework | Clause | Covered Sections |
|------------|---------|----------------|
| **SOC 2** (CC7.2, CC7.3, CC6.6) | Processing integrity, retention, access control | §§ 2 – 8 |
| **ISO 27001** (A.12.4.2 – A.12.4.3, A.18.1.3) | Protection of log information & records | §§ 2 – 8 |

---

# 10. Attachments

1. Sample `MANIFEST.json` and `MANIFEST.sig` (redacted)  
2. CloudTrail log excerpt for `kms:Sign`  
3. Terraform snippet showing Object Lock enabled  
4. Athena verification query output sample

---

*Generated automatically by Aegis CI Pipeline on {{REPORT_DATE}}*
